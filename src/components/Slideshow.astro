---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  // img_metadata: Record<string, () => Promise<{ default: ImageMetadata }>>;
  img_metadata: Record<string, any>;
}

const { img_metadata } = Astro.props;

const metadata: ImageMetadata[] = img_metadata.map(
  (file: Record<string, any>) => file.default,
);
---

<div class="slideshow" id="slideshow">
  {
    metadata.map((image: ImageMetadata, index: number) => (
      <a class="img-container" href={"#"}>
        <Image
          class="landing-img"
          src={image}
          alt=""
          widths={[240, 540, 720, image.width]}
          sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 1600px) 720px, ${image.width}px`}
          style={`animation-delay: ${6 * index}s;`}
        />
      </a>
    ))
  }
</div>

<style>
  .slideshow {
    background: black;
    position: relative;
    overflow: hidden;
    display: flex;
    /* align-items: flex-end; */
  }

  .img-container {
    display: flex;
    justify-content: center;
    align-items: center;
    position: absolute;
    top: 0;
  }

  .landing-img {
    background: black;
    /* position: absolute; */
    /* top: 0; */
    /* left: 0; */
    opacity: 0;
    transform: scale(1.4) translate(10%, 10%);
    animation: animate 20s infinite;
  }

  @keyframes animate {
    25% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0;
    }
  }
</style>

<script is:inline data-astro-rerun>
  document.addEventListener("astro:page-load", () => {
    let slideshow = document.getElementById("slideshow");
    let header_height = document.getElementById("header").offsetHeight;

    slideshow.style.height = `calc(100vh - ${header_height}px)`;
  });
</script>
